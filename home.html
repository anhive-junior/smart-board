<!DOCTYPE html >
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" href="favicon.ico" type="image/x-icon" />   
	<link rel="stylesheet" type="text/css" href="signage.base.css">
    <script type="text/javascript" src="signage.base.js"></script>
    <title>SweetHome</title>
	<style>

    table {
        text-align : center;
    }
	
    .tile {
        margin: 3px;
        padding-top: 17px;
        padding-bottom: 17px;
        cursor : pointer;
        border: solid 1px #e4e4e4;
				color:#fff;
        background: #efefef; 
        border-radius: 2px;
    }
	.tile:active { background:green; }
	
	.tiletitle{
        /*border-bottom: dotted 1px #e4e4e4;*/
        font-size:1.7em;
        font-weight:bold; 
				color:#fff;
	}
	.tiletitle:active { background:green; }

    .instruction {
        color:#555555;
		font-size:1.2em;
        font-weight:bold; 
		padding-top:0.6em;
    }

    </style>
</head>
<body > 
    <div class="container">
        <div class="contents">

			<!-- head note -->
			<div class='headnote' onclick="javascript:document.location.href='home.html'">
				<img id="headnote_img" style="height:15px">
				<span class="input_title"></span>
				<span class="input_title"></span>
			</div>

			<div style="margin-top:5px;"><!-- upper line feed --></div>
			<div id="contents" style="text-align:center; margin: 0 auto;">
				<div id='content_none' class="tile" style="display:none;background-color:#f86924">
					<div class="tiletitle" ></div>
					<div class="instruction" ></div>
				</div>
			</div>

			<div style="margin-top:5px;"><!-- upper line feed --></div>
			<div class="button_base" style="text-align:center">
				<span id='button_none' class="button_span" style="display:none"></span>
			</div>
			<div style="margin-top:10px;"><!-- upper line feed --></div>
		</div>
	</div>
	<div class='footer' ></div>
<script>

var contents = document.getElementById("contents");
var footer = document.getElementsByClassName("footer")[0];
var buttons = document.getElementsByClassName("button_base")[0];

var headnote = function(){ // headnote에 대한 데이터를 가지고 옵니다.
	var data = new FormData(); 
	data.append("init", 1);
	var request = new XMLHttpRequest();
	request.onreadystatechange = function(){
		if(request.readyState == 4){
			try {
				var resp = JSON.parse(request.response);
			} catch(e){
				var resp = {
					status : 'error',
					data: 'Unknown error occurred : [' + request.responseText + ']'
				};
			}
			console.log(resp.status + ':' + resp.data);
			document.getElementsByTagName("img")[0].setAttribute("src", resp.data.photo[0]);
			document.getElementsByTagName("img")[0].setAttribute("alt", resp.data.photo[1]);
			document.getElementsByClassName("input_title")[0].innerHTML=resp.data.subject;
			document.getElementsByClassName("input_title")[1].innerHTML=resp.data.owner;
			document.getElementsByClassName("footer")[0].innerHTML=resp.data.footer;
		}
	};
	request.open("POST", "home.php");
	request.send(data);
}

var level_contents = function(){ // level에 따른 contents를 가지고 옴
	var request = new XMLHttpRequest();
	request.onreadystatechange = function(){
	if(request.readyState == 4){
		try {
			var resp = JSON.parse(request.response);
		} catch (e) {
		var resp = {
			status: 'error',
			data: 'Unknown error occurred : [' + request.responseText + ']'
			};
		}
		console.log(resp.status + ' : ' + resp.data.link.length);
		for(let i=0; i<resp.data.link.length; i++){
			let clone = document.getElementById("content_none").cloneNode(true);
			contents.appendChild(clone);
			clone.setAttribute("id","norm" + (i+1));
			document.getElementById("norm" + (i+1)).style.display="block";
			document.getElementById("norm" + (i+1)).setAttribute("onclick", "window.open('"+resp.data.link[i]+"', '_self');");
			document.getElementsByClassName("tiletitle")[i+1].innerHTML=resp.data.tiletitle[i];
			document.getElementsByClassName("instruction")[i+1].innerHTML = resp.data.ins[i];
			document.getElementsByClassName("tile")[i+1].style.backgroundColor = resp.data.color[i];
			}
		}
	};
request.open('POST', 'home.php');
request.send();
}

var bottom_button = function(){
	var data = new FormData();
	data.append("button", 1);
	var request = new XMLHttpRequest();
	request.onreadystatechange = function(){
		if(request.readyState == 4){
			try {
				var resp = JSON.parse(request.response);
			} catch (e){
				var resp = {
					status : 'error',
					data : 'Unkonwn error occurred : [' + request.responseText + ']'
				};
			}
			console.log(resp.status + ' : ' + resp.data.link.length);
			if(resp.data == "0") return;
			for(let i=0; i<resp.data.link.length; i++){
				let clone = document.getElementById("button_none").cloneNode(true);
				buttons.appendChild(clone);
				clone.style.display="inline-block";
				clone.setAttribute("id", "b" + (i+1));
				document.getElementById("b" + (i+1)).setAttribute("onclick", "window.open('"+resp.data.link[i]+"', '_self');");
				document.getElementById("b" + (i+1)).innerHTML = resp.data.spanInner[i];
			}
		}
	};
	request.open("POST", "home.php");
	request.send(data);
}

headnote();
level_contents();
bottom_button();
	
</script>	
</body>
</html>
