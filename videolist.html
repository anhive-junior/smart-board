<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" href="favicon.ico" type="image/x-icon" />   
    <script type="text/javascript" src="signage.base.js"></script>
    <link rel="stylesheet" type="text/css" href="signage.base.css">
    <title>Video List</title>
    <style>
.videoitem {
    color:red; 
    padding: 3px;
    padding_top: 6px;
    padding_bottom: 6px;
    margin: 2px;
    background-color: lightgray;
    word-break: break-all;
}
    </style>
</head>
<body >
    <div class="container" >
        <div class="contents">
        
            <!-- head note -->
            <div class='headnote'>
                <span class="input_title">비디오목록</span>
            </div>
            <div style="margin-top:10px;"><!-- upper line feed --></div>
            
            <div id="position1">
            <br>
            </div>
            
            <a id="link1"></a><br>
            <div class="videoitem"></div>
    </div>
    <div class='footer' ></div>
<script>
var useusb = function (usb) {
    opener.showvideos(usb);
}

var usbcheck = function(){ // headnote에 대한 데이터를 가지고 옵니다.
    var data = new FormData(); 
    data.append("func", "usbcheck");
    //data.append("usbcheck", 1);
    var request = new XMLHttpRequest();
    request.onreadystatechange = function(){
        if(request.readyState == 4){
            try {
                var resp = JSON.parse(request.response);
            } catch(e){
                var resp = {
                    status : 'error',
                    data: 'Unknown error occurred : [' + request.responseText + ']'
                };
            }
            console.log(resp.status + ':' + resp.data);
            
            document.getElementById("position1").innerHTML = "위치:[USB] [" + resp.data.position + "] or  <input type='button' id='usb1'>";
            document.getElementById("usb1").setAttribute("onclick",resp.data.func);
            document.getElementById("usb1").setAttribute("value",resp.data.value);
            document.getElementsByClassName("footer")[0].setAttribute("id","footer1");
            document.getElementById("footer1").innerHTML=resp.data.footer;
        }
    };
    request.open("POST", "videolist.php");
    request.send(data);
}

var filecheck = function(){ // headnote에 대한 데이터를 가지고 옵니다.
    var data = new FormData(); 
    data.append("func","filecheck");
    //data.append("filecheck", 1);
    var request = new XMLHttpRequest();
    request.onreadystatechange = function(){
        if(request.readyState == 4){
            try {
                var resp = JSON.parse(request.response);
            } catch(e){
                var resp = {
                    status : 'error',
                    data: 'Unknown error occurred : [' + request.responseText + ']'
                };
            }
            console.log(resp.status + ':' + resp.data);
            
            if(resp.data.link != "" && resp.data.position !=""){
                    document.getElementById("link1").setAttribute("href",resp.data.link);
                     document.getElementById("link1").innerHTML = "[DIRECTORY]" + resp.data.position;
            }
            document.getElementsByClassName("videoitem")[0].setAttribute("id",resp.data.id);
            document.getElementById(resp.data.id).setAttribute("onclick" , resp.data.func);
            document.getElementById(resp.data.id).innerHTML = resp.data.info;
            
        }
    };
    request.open("POST", "videolist.php");
    request.send(data);
}
usbcheck();
filecheck();

</script>
</body>
</html>
