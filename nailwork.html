<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" href="favicon.ico" type="image/x-icon" />   
    <script type="text/javascript" src="signage.base.js"></script>
    <link rel="stylesheet" type="text/css" href="signage.base.css">
    <title>AnHive, List Media Files</title>
    <style>
    .img_block{    position: relative;    width: 80px; height: 80px;}
    .img_base{    width: 100%;height: 100%;background: blue;}
    .img_tag{position: absolute;bottom: 5px;right: 5px;    width: 24px;
        height: 24px;background: yellow;}
    .img_tag:active {background: red;}
    </style>    
</head>
<body >
    <div class="container">
        <div class="contents">
        
            <!-- head note -->
            <div class='headnote' onclick="javascript:document.location.href='home.html'">
                <img id="headnote_img" style="height:15px;" alt="profile">
                <span class="input_title" id="subject"></span> 
                <span class="input_title" id="owner"></span>
            </div>
            <div style="margin-top:10px;"><!-- upper line feed --></div>

            <div id="packinglist" style > </div>
            
            <div style="display: inline-block;padding-top:10px;width:100%;text-align:center;">
    
            </div>
        </div>
    </div>
    <div class='footer' id="foot_note"></div>
    <div id="html_data_model" style="display:none;">
        <div id="block">
            <div style="margin:10px;padding:2px;"><!-- upper line feed --></div>
            <div style="background-color:#ccc;">
                *0*block*0*<br>
            </div>
            <div style="margin:2px;padding:2px;"><!-- upper line feed --></div>
        </div>
        <div id="image">
            <div  style="display:inline-block;">
                <div class="img_block">
                    <img class="img_base" src="*0*thumb*0*" onclick="window.open( 'openimages.html?name=*0*file*0*', '_self');" alt="thumbnail"> 
                </div> 
                <div style="font-size:0.7em;text-align:center;padding-buttom:10px;">
                    <span style="">*0*elapse*0*</span>
                </div> 
            </div>
        </div>
    </div>
    <div id="content_name" style="display:none">slide</div>
</body>
<script>

var headnote = function(){ // headnote 및 footer에 대한 데이터를 가지고 옵니다. - 초기설정
    var data = new FormData(); 
    data.append("func", "headnote");
    POST("s00_signage.php", data, function(resp){
            console.log("headnote - " + resp.status + ':' + resp.data);
            document.getElementById("headnote_img").setAttribute("src", resp.data.photo);
            document.getElementById("subject").innerHTML=resp.data.subject;
            document.getElementById("owner").innerHTML=resp.data.owner;
            document.getElementById("foot_note").innerHTML=resp.data.footer;
    });
}
var getlist = function (){
    
    var data = new FormData();
    data.append('func', 'getplaylist');
    data.append('contents', 'document.getElementById("content_name").innerHTML');
    var request = new XMLHttpRequest();
    request.onreadystatechange = function(){
        if(request.readyState == 4){
            try {
                var resp = JSON.parse(request.response);
            } catch (e){
                var resp = {
                    status: 'error',
                    data: 'Unknown error occurred: [' + request.responseText + ']'
                };
            }
            var fdiv = document.getElementById("packinglist");
            fdiv.innerHTML = "";
            block = document.getElementById("block").innerHTML;
            image = document.getElementById("image").innerHTML;
            innerhtml = "";
            for (i=0; i<resp.data.length; i++) {
                slide = resp.data[i];
                console.log (slide.term+slide.thumb);
                segment = (slide.block != "")?block:"";
                segment += image;
                segment = segment
                        .replace("*0*term*0*"  , slide.term       )
                        .replace("*0*block*0*"  , slide.block     )
                        .replace("*0*thumb*0*"  , slide.thumb     )
                        .replace("*0*file*0*"  , slide.file       )
                        .replace("*0*elapse*0*"  , slide.elapse   );
                innerhtml += segment;
            }
            fdiv.innerHTML = innerhtml;
        }
    };
    request.open('POST', 's00_signage.php');
    request.send(data);
    return request;
}

headnote();
getlist();
 
</script>
</html>